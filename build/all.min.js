var app;this.ATtinder=this.ATtinder||{},app=function(e,t){var n;return n=new t.Application,n.rootRoute="dashboard",n.Radio=e.Radio,n.addRegions({mainRegion:"#main-region"}),n.addInitializer(function(){return n.module("TinderImage").start()}),n.on("start",function(t){if(e.history&&(e.history.start({pushstate:!0}),""===e.history.fragment))return this.navigate(this.rootRoute,{trigger:!0})}),n}(Backbone,Marionette),$.extend(this.ATtinder,app),function(e){return _.extend(e.Marionette.Application.prototype,{navigate:function(t,n){return null==n&&(n={}),e.history.navigate(t,n)}})}(Backbone),Backbone.Marionette.Renderer.render=function(e,t){return JST[""+e](t)};var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("Entities",function(e,t,n,r,o,i){var a;return e.Image=function(e){function t(e){t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.defaults=function(){return{src:"http://atmedia.imgix.net/",gallery_width:"300",gallery_height:"200",loaded:!1}},t}(n.Model),e.Images=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.model=e.Image,n.prototype.preload=function(){return i.each(this.where({loaded:!1}),function(e){var t;return t=new Image,t.onload=function(){return e.set({loaded:!0})},t.src=""+e.get("src")+e.get("id")})},n}(n.Collection),a={getImages:function(e,n){return o.getJSON("http://www.apartmenttherapy.com/admin/galleries/sample.json",function(e){var r;return r=i.map(e,function(e){return new t.Entities.Image({id:e})}),n(r)})}},t.reqres.setHandler("entities:images",function(e,t){return a.getImages(e,t)})});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("Entities",function(e,t,n,r,o,i){return e.User=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(n.Model)}),this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){return e.Controller={initialize:function(){return o(".nav a").removeClass("active"),this.images=new t.Entities.Images,this.liked=new t.Entities.Images},show:function(n){return this.layout=new e.LayoutView({childEvents:{"new:image":function(e){return function(t){return e.likeImage(t)}}(this)}}),this.layout.on("show",function(t){return function(){return t.layout.navRegion.show(new e.Nav),o(".nav ."+n).addClass("active"),t.dashboardTabFactory(n)}}(this)),t.mainRegion.show(this.layout)},dashboardTabFactory:function(t){switch(t){case"tinder":return 0===this.images.length?this.loadImages():this.showImage();case"gallery":return this.layout.contentRegion.show(new e.Gallery({collection:this.liked,childView:{}}))}},loadImages:function(){return t.request("entities:images",{},function(e){return function(t){return e.images.add(t),e.images.preload(),e.showImage()}}(this))},showImage:function(){return this.images.length<3?this.loadImages():(this.image=this.images.shift(),this.layout.contentRegion.show(new e.Tinder({model:this.image})))},likeImage:function(e){return e.model.get("like")&&this.liked.add(this.image),this.showImage()}}});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){var a;return e.Router=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,t),n.prototype.appRoutes={dashboard:"showTinder","dashboard(/:tab)(/)":"showTab","dashboard/*notFound":"notFound"},n.prototype.initialize=function(){return e.Controller.initialize()},n}(r.AppRouter),a={showTinder:function(){return e.Controller.show("tinder")},showTab:function(t){var n;return n=["tinder","gallery"],i.include(n,t)||(t="tinder"),e.Controller.show(t)},notFound:function(){return t.navigate("dashboard",{trigger:!0,replace:!0})}},e.addInitializer(function(){return new e.Router({controller:a})})}),window.JST||(window.JST={}),window.JST.image=function(e){e||(e={});var t,n=[],r=function(e){return e&&e.ecoSafe?e:"undefined"!=typeof e&&null!=e?i(e):""},o=e.safe,i=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;"undefined"!=typeof e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},i||(i=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<img class="image img-thumbnail img-responsive"\n    src="'),n.push(r(this.src+this.id)),n.push("?w="),n.push(r(this.gallery_width)),n.push("&h="),n.push(r(this.gallery_height)),n.push('">\n')}).call(this)}.call(e),e.safe=o,e.escape=i,n.join("")},window.JST||(window.JST={}),window.JST.layout=function(e){e||(e={});var t,n=[],r=e.safe,o=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;"undefined"!=typeof e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<div class="dashboard-nav"></div>\n<div class="dashboard-content"></div>\n')}).call(this)}.call(e),e.safe=r,e.escape=o,n.join("")},window.JST||(window.JST={}),window.JST.nav=function(e){e||(e={});var t,n=[],r=e.safe,o=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;"undefined"!=typeof e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},o||(o=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<div class="header clearfix">\n  <nav>\n    <ul class="nav nav-pills pull-right">\n      <li role="presentation">\n        <a class="btn btn-primary tinder" href="#dashboard/tinder">Tinder<div class="ripple-container"></div></a></li>\n      <li role="presentation">\n        <a class="btn btn-primary gallery" href="#dashboard/gallery">Gallery<div class="ripple-container"></div></a></li>\n    </ul>\n  </nav>\n  <h3 class="text-muted">Apartment Therapy</h3>\n</div>\n')}).call(this)}.call(e),e.safe=r,e.escape=o,n.join("")},window.JST||(window.JST={}),window.JST.tinder=function(e){e||(e={});var t,n=[],r=function(e){return e&&e.ecoSafe?e:"undefined"!=typeof e&&null!=e?i(e):""},o=e.safe,i=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;"undefined"!=typeof e&&null!=e||(e="");var t=new String(e);return t.ecoSafe=!0,t},i||(i=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<div class="jumbotron">\n  <div id="tinder" class="content tinder">\n    <a class="btn btn-lg btn-primary dislike pull-left" href="#" role="button">DISLIKE</a>\n    <a class="btn btn-lg btn-primary like pull-right" href="#" role="button">LIKE</a>\n    <img class="image img-thumbnail img-responsive" src="'),n.push(r(this.src+this.id)),n.push('">\n  </div>\n  <div class="content loading">loading...</div>\n</div>\n')}).call(this)}.call(e),e.safe=o,e.escape=i,n.join("")};var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){return e.GalleryImage=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template="image",t.prototype.className="gallery-image",t}(r.ItemView),e.Gallery=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,e),n.prototype.className="jumbotron",n.prototype.buildChildView=function(e,n,r){return new t.TinderImage.GalleryImage({model:e})},n}(r.CollectionView)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){return e.LayoutView=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template="layout",t.prototype.regions={navRegion:".dashboard-nav",contentRegion:".dashboard-content"},t}(r.LayoutView)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){return e.Nav=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template="nav",t}(r.ItemView)});var __hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};this.ATtinder.module("TinderImage",function(e,t,n,r,o,i){return e.Tinder=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.template="tinder",t.prototype.ui={like:".like",dislike:".dislike",tinder:".tinder",loading:".loading"},t.prototype.events={"click @ui.like":function(){return this.updateTinder(!0)},"click @ui.dislike":function(){return this.updateTinder(!1)}},t.prototype.modelEvents=function(){return{"change:loaded":function(e){return this.ui.loading.hide(),this.ui.tinder.fadeIn()}}},t.prototype.onRender=function(){if(!this.model.get("loaded"))return this.ui.tinder.hide(),this.ui.loading.show()},t.prototype.updateTinder=function(e){return this.model.set({like:e}),this.triggerMethod("new:image")},t}(r.ItemView)});